<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <!-- NAVIGATON PANEL / HEADER -->
    <nav th:fragment="navigbar" class="navbar navbar-expand-lg bg-transient container-md d-flex justify-content-around sticky-top">
      <a class="navbar-brand" th:href="@{/}" style="color: #33DFF0"><img th:src = "@{/icons/icons8-book-50.png}"><b>LibHub</b></a>
      <form class="d-flex container" method="post" th:action = "@{/}">
        <input class="form-control me-2" name="title" type="search" placeholder="Поиск" aria-label="Поиск">
      </form>
      <!-- <a class="navbar-brand" th:href="@{/login}"><img th:src = "@{/icons/icons8-male-user-50.png}"></a> -->
      <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#LogInModal">Войти</button>
    </nav>

    <!-- MODAL WINDOW FOR LOGIN -->
    <div th:fragment="modalLogIn" class="modal fade" id="LogInModal" tabindex="-1" aria-labelledby="LogInModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="LogInModalLabel">Вход</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Закрыть"></button>
          </div>
          <div class="modal-body">
            <form id="loginForm" method="post" th:action="@{/login/process}">
                <div class="mb-3" style="width: 80%;">
                    <label class="form-label"><b>Номер телефона</b></label>
                    <input type="tel" name="phoneNumber" id="phoneNumber" class="form-control border-dark" oninput="validatePhoneNumber(this)" autocomplete="tel" minlength="11" maxlength="11" required>
                    <small id="phoneLengthError" style="color: red; display: none;">Неверный формат номра телефона</small>
                </div>
                <div class="mb-3" style="width: 80%;">
                    <label class="form-label"><b>Пароль</b></label>
                    <input type="password" id="password" name = "password" class="form-control border-dark" minlength="5" autocomplete="new-password" required>
                </div>
            </form>
            <div class="modal-footer d-flex justify-content-start">
                <button class="btn btn-outline-primary me-3" id="submitButton" type="submit">Войти</button>
                <span>Еще нет аккаунта? <a class="link-primary" type="button" data-bs-toggle="modal" data-bs-target="#RegModal">Зарегистрироваться</a></span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- MODAL WINDOW FOR REG -->
    <div th:fragment="modalReg" class="modal fade" id="RegModal" tabindex="-1" aria-labelledby="RegModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
              <div class="modal-header">
                <h1 class="modal-title fs-5" id="RegModalLabel">Регистрация</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Закрыть"></button>
              </div>
              <div class="modal-body">
                <form id="regForm" method="post" th:action="@{/auth/reg}">
                    <div class="mb-3" style="width: 80%;">
                        <label for="firstName" class="form-label"><b>Имя</b></label>
                        <input type="text" name="firstName" id="firstName" class="form-control border-dark" oninput="validateRussianInput(this)" autocomplete="name" required>
                    </div>
                    <div class="mb-3" style="width: 80%;">
                        <label for="lastName" class="form-label"><b>Фамилия</b></label>
                        <input type="text" name="lastName" id="lastName" class="form-control border-dark" oninput="validateRussianInput(this)" autocomplete="family-name" required>
                    </div>
                    <div class="mb-3" style="width: 80%;">
                        <label for="phoneNumber" class="form-label"><b>Номер телефона</b></label>
                        <input type="tel" name="phoneNumber" id="phoneNumber" class="form-control border-dark" oninput="validatePhoneNumber(this)" autocomplete="tel" minlength="11" maxlength="11" required>
                        <small id="phoneLengthError" style="color: red; display: none;">Неверный формат номра телефона</small>
                    </div>
                    <div class="mb-3" style="width: 80%;">
                        <label for="email" class="form-label"><b>Электронная почта</b></label>
                        <input type="email" name="email" id="email" class="form-control border-dark" autocomplete="email">
                    </div>
                    <div class="mb-3" style="width: 80%;">
                        <label for="password" class="form-label"><b>Пароль</b></label>
                        <input type="password" id="password" name = "password" class="form-control border-dark" minlength="5" autocomplete="new-password" required>
                    </div>
                    <div class="mb-3" style="width: 80%;">
                        <label for="passwordRep" class="form-label"><b>Повторите пароль</b></label>
                        <input type="password" id="passwordRep" name = "passwordRep" class="form-control border-dark" minlength="5" autocomplete="new-password" required>
                        <small id="passwordMatchError" style="color: red; display: none;">Пароли не совпадают</small>
                    </div>
                        <button class="btn btn-outline-primary" id="submitButton" type="submit">Зарегистрироваться</button>
                        <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#LogInModal">Назад</button>
                </form>
              </div>
            </div>
          </div>
        </div>

    <!-- OFFCANVAS FOR BOOKS AND AUTHORS MANAGMENT-->
    <div th:fragment="contentList" class="offcanvas offcanvas-start" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="ManageMenu">
      <div class="offcanvas-header border-3 border-bottom">
          <h5 class="offcanvas-title">Выбор содержимого</h5>
          <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Закрыть"></button>
      </div>
      <div class="offcanvas-body">
          <div>
              <a class="nav-item d-inline fs-3 link-dark" th:href="@{/lib-books}">Книги</a>
          </div>
          <div class="mt-3">
              <a class="nav-item d-inline fs-3 link-dark" th:href="@{/lib-authors}">Авторы</a>
          </div>
      </div>
  </div>

  <!-- PAGINATION FOR BOOKS AND AUTHORS MANAGMENT-->
  <div th:fragment="pagination_m">
    <div class="hstack gap-2 mb-3" th:if="${totalPages} > 1">
      <div class="pagination">
          <li class="page-item">
              <a th:if="${currPage != 1}" class="page-link" th:href="${1}">&laquo;</a>
              <span th:unless="${currPage != 1}" class="page-link">&laquo;</span>
          </li>
          <li class="page-item">
              <a th:if="${currPage != 1}" class="page-link" th:href="${currPage - 1}">Предыдущая</a>
              <span th:unless="${currPage != 1}" class="page-link">Предыдущая</span>
          </li>
      </div>

      <div th:if="${totalPages > pagesAmount}" class="pagination hstack gap-2">
          <div th:if="${pagesAmount > currPage}" th:each="i: ${#numbers.sequence(1, pagesAmount)}">
              <li class="page-item">
                  <a th:if="${currPage != i}" class="page-link" th:href="${i}">[[${i}]]</a>
                  <span th:unless="${currPage != i}" class="page-link">[[${i}]]</span>
              </li>
          </div>
          <div th:unless="${pagesAmount > currPage}" class="pagination hstack gap-2">
              <div th:if="${currPage != totalPages}" th:each="i: ${#numbers.sequence(currPage - pagesAmount + 2, currPage + 1)}">
                  <li class="page-item">
                      <a th:if="${currPage != i}" class="page-link" th:href="${i}">[[${i}]]</a>
                      <span th:unless="${currPage != i}" class="page-link">[[${i}]]</span>
                  </li>
              </div>
              <div th:unless="${currPage != totalPages}" th:each="i: ${#numbers.sequence(currPage - pagesAmount + 1, currPage)}">
                  <li class="page-item">
                      <a th:if="${currPage != i}" class="page-link" th:href="${i}">[[${i}]]</a>
                      <span th:unless="${currPage != i}" class="page-link">[[${i}]]</span>
                  </li>
              </div>
          </div>
      </div>
      <div th:unless="${totalPages > pagesAmount}" class="pagination hstack gap-2">
          <div th:if="${pagesAmount > currPage}" th:each="i: ${#numbers.sequence(1, totalPages)}">
              <li class="page-item">
                  <a th:if="${currPage != i}" class="page-link" th:href="${i}">[[${i}]]</a>
                  <span th:unless="${currPage != i}" class="page-link">[[${i}]]</span>
              </li>
          </div>
      </div>
     
      <div class="pagination">
          <li class="page-item">
              <a th:if="${currPage != totalPages}" class="page-link" th:href="${currPage + 1}">Следующая</a>
              <span th:unless="${currPage != totalPages}" class="page-link">Следующая</span>
          </li>
          <li class="page-item">
              <a th:if="${currPage != totalPages}" class="page-link" th:href="${totalPages}">&raquo;</a>
              <span th:unless="${currPage != totalPages}" class="page-link">&raquo;</span>
          </li>
      </div>    
  </div>
  </div>
    
</body>
</html>